<% provide(:title, 'Archive') %>
<div class="row">
  <div class="offset1 span9">
    <ul class="nav nav-tabs">
      <li><%= link_to "Ward List", ward_path %></li>
      <li><%= link_to "Investigators", investigators_path %></li>
      <li><%= link_to "Watch List", watch_path %></li>
      <li><%= link_to "Find Report", reports_path %></li>
      <li><%= link_to "Report Activity", newactivity_path %></li>
      <li class="active"><%= link_to "Archive", archive_path %></li>
    </ul>
  </div>
</div>
<div class="container">
  <fullbody class="span11">
    <%= render 'report' %>
    <div class="span2">
      <%= collection_select(nil, :family_id, Family.where("archived = ?", true), :id, :name, {:prompt => "Select a family"}, 
                            {:onchange => "redirect_to_archive(this.value)", :class => "btn btn-medium btn-secondary"}) %>
    </div>
    <%= javascript_tag do %>
      function redirect_to_archive(familyId){
        window.location = "<%= archive_path %>?family_id=" + familyId;
      } 
    <% end %>
    <% if @selected_family %>
      <div class="span2">
        <%= link_to "Unarchive Family", archive_path(:unarchive_id => @selected_family.id), class: "btn btn-medium btn-warning",
                    confirm: "Are you sure you want to unarchive this family?", "data-confirm-fade" => true, 
                    "data-confirm-title" => "Unarchive #{@selected_family.name}", "data-confirm-proceed" => "Unarchive", 
                    "data-confirm-proceed-class" => "btn-warning" %>
      </div>
      <div class="offset4 span2">
        <%= link_to "Delete Family", @selected_family, method: :delete, class: "btn btn-medium btn-danger",
                    confirm: "Are you sure you want to delete this family and all of its activity records?", "data-confirm-fade" => true, 
                    "data-confirm-title" => "Delete #{@selected_family.name}", "data-confirm-proceed" => "Delete", 
                    "data-confirm-proceed-class" => "btn-danger" %>
      </div>
    <% end %>
  </fullbody>
</div>
